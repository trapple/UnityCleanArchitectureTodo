# Unity Clean Architecture Todo

Unityã§Clean Architectureãƒ‘ã‚¿ãƒ¼ãƒ³ã¨MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’é©ç”¨ã—ãŸTodoã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### Clean Architecture + MVVM
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯**Clean Architecture**ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€**Presentationå±¤ã«MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ã‚’æ¡ç”¨ã—ãŸè¨­è¨ˆã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Presentation                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    View     â”‚  â”‚ ViewModel   â”‚  â”‚  Presenter  â”‚    â”‚
â”‚  â”‚  (Unity UI) â”‚â†’ â”‚ (R3 State)  â”‚â† â”‚ (Business)  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Application                          â”‚
â”‚         TodoUseCase (çµ±åˆå‹CRUDæ“ä½œ)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Domain                             â”‚
â”‚  TodoTask Entity + ITodoRepository Interface           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Infrastructure                         â”‚
â”‚      CsvTodoRepository (ãƒ•ã‚¡ã‚¤ãƒ«æ°¸ç¶šåŒ–)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è©³ç´°å®Ÿè£…

#### ğŸ¯ View (Unity UI)
- **å½¹å‰²**: UIè¡¨ç¤ºã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®å—ä»˜
- **æŠ€è¡“**: Unity UI Components
- **ç‰¹å¾´**: ViewModelã¨ã®åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°

```csharp
// Viewã¯ViewModelã®çŠ¶æ…‹ã‚’ç›£è¦–ã—ã€UIã«åæ˜ 
_viewModel.Todos
    .Subscribe(OnTodosChanged)
    .AddTo(_disposables);

// UIã‚¤ãƒ™ãƒ³ãƒˆã‚’ViewModelã®Commandã«ãƒã‚¤ãƒ³ãƒ‰
_addButton.onClick.AsObservable()
    .Subscribe(_ => _viewModel.CreateTodoCommand.Execute(Unit.Default))
    .AddTo(_disposables);
```

#### ğŸ§  ViewModel (çŠ¶æ…‹ç®¡ç†)
- **å½¹å‰²**: UIçŠ¶æ…‹ã®ç®¡ç†ã¨Commandã®å®šç¾©
- **æŠ€è¡“**: R3 ReactiveProperty + ReactiveCommand
- **ç‰¹å¾´**: ç´”ç²‹ãªçŠ¶æ…‹ã¨ã‚³ãƒãƒ³ãƒ‰ã®ã¿ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯å«ã¾ãªã„

```csharp
public class TodoListViewModel : IDisposable
{
    // çŠ¶æ…‹ç®¡ç†
    public ReadOnlyReactiveProperty<IReadOnlyList<TodoTask>> Todos { get; }
    public ReadOnlyReactiveProperty<bool> IsLoading { get; }
    public ReactiveProperty<string> NewTodoTitle { get; }
    
    // ã‚³ãƒãƒ³ãƒ‰å®šç¾©
    public ReactiveCommand CreateTodoCommand { get; }
    public ReactiveCommand<string> ToggleCompleteCommand { get; }
    public ReactiveCommand<string> DeleteTodoCommand { get; }
}
```

#### ğŸ¬ Presenter (ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯)
- **å½¹å‰²**: ViewModelã¨UseCaseã®æ©‹æ¸¡ã—ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè¡Œ
- **æŠ€è¡“**: VContainer EntryPoint + UniTask
- **ç‰¹å¾´**: Commandã¨UseCaseã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã€è‡ªå‹•åˆæœŸåŒ–

```csharp
public class TodoListPresenter : IStartable, IDisposable
{
    // ViewModelã®Commandã‚’UseCaseã«ãƒã‚¤ãƒ³ãƒ‰
    private void BindCommands()
    {
        _viewModel.CreateTodoCommand
            .Subscribe(_ => OnCreateTodoAsync().Forget())
            .AddTo(_disposables);
    }
    
    // ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè¡Œ
    private async UniTask OnCreateTodoAsync()
    {
        await _todoUseCase.CreateAsync(_viewModel.NewTodoTitle.Value, 
                                     _viewModel.NewTodoDescription.Value);
        await LoadTodosAsync();
    }
}
```

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### Core Framework
- **Unity** - ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ãƒ»UIæ¡†æ¶
- **Clean Architecture** - ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- **MVVM Pattern** - Presentationå±¤ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³

### ä¾å­˜æ€§æ³¨å…¥ãƒ»éåŒæœŸå‡¦ç†
- **VContainer** - ä¾å­˜æ€§æ³¨å…¥ã‚³ãƒ³ãƒ†ãƒŠ
- **UniTask** - é«˜æ€§èƒ½éåŒæœŸå‡¦ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **R3** - ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

### UIãƒ»è¡¨ç¤º
- **NotoSansJP** - æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆå¯¾å¿œ
- **SafeAreaHandler** - ãƒ¢ãƒã‚¤ãƒ«ç«¯æœ«SafeAreaè‡ªå‹•å¯¾å¿œ

### é–‹ç™ºãƒ»å“è³ªä¿è¨¼
- **TDD (Test-Driven Development)** - ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º
- **EditorScript** - UIæ§‹ç¯‰è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«
- **Assembly Definition Files** - ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢ã®å¼·åˆ¶

## ğŸ¯ ä¸»è¦æ©Ÿèƒ½

### Todoã‚¢ãƒ—ãƒªæ©Ÿèƒ½
- âœ… **ã‚¿ã‚¹ã‚¯ä½œæˆ** - ã‚¿ã‚¤ãƒˆãƒ«ãƒ»èª¬æ˜ä»˜ãã‚¿ã‚¹ã‚¯ä½œæˆ
- âœ… **å®Œäº†åˆ‡ã‚Šæ›¿ãˆ** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹æ›´æ–°
- âœ… **ã‚¿ã‚¹ã‚¯å‰Šé™¤** - å³åº§å‰Šé™¤ãƒ»ãƒªã‚¹ãƒˆæ›´æ–°
- âœ… **ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–** - CSVå½¢å¼ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜
- âœ… **çµ±è¨ˆè¡¨ç¤º** - ã‚¿ã‚¹ã‚¯æ•°ãƒ»å®Œäº†æ•°è¡¨ç¤º
- âœ… **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹** - éåŒæœŸæ“ä½œã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

### æŠ€è¡“çš„ç‰¹å¾´
- ğŸ—ï¸ **å®Œå…¨ãªå±¤åˆ†é›¢** - Domain, Application, Infrastructure, Presentation
- ğŸ§ª **TDDå“è³ªä¿è¨¼** - Red-Green-Refactorã‚µã‚¤ã‚¯ãƒ«
- âš›ï¸ **ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–UI** - R3ã«ã‚ˆã‚‹åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
- ğŸ”§ **é–‹ç™ºåŠ¹ç‡åŒ–** - EditorScriptã«ã‚ˆã‚‹è‡ªå‹•UIæ§‹ç¯‰
- ğŸ“± **ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ** - iPhone/Androidã®SafeAreaè‡ªå‹•å¯¾å¿œ
- ğŸŒ **å›½éš›åŒ–å¯¾å¿œ** - æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆå®Œå…¨å¯¾å¿œ

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
UnityCleanArchitechtureTodo/
â”œâ”€â”€ Assets/
â”‚   â”œâ”€â”€ Scripts/
â”‚   â”‚   â”œâ”€â”€ Domain/           # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ Entities/     # ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆTodoTaskï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ Repositories/ # ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ App/              # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤  
â”‚   â”‚   â”‚   â””â”€â”€ UseCases/     # ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼ˆTodoUseCaseï¼‰
â”‚   â”‚   â”œâ”€â”€ Infra/            # ã‚¤ãƒ³ãƒ•ãƒ©å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ Repositories/ # ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ï¼ˆCsvTodoRepositoryï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ LifetimeScope/# DIè¨­å®šï¼ˆRootLifetimeScopeï¼‰
â”‚   â”‚   â””â”€â”€ Presentation/     # ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆMVVMï¼‰
â”‚   â”‚       â”œâ”€â”€ ViewModels/   # ViewModelï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰
â”‚   â”‚       â”œâ”€â”€ Presenters/   # Presenterï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
â”‚   â”‚       â”œâ”€â”€ Views/        # Viewï¼ˆUnity UIï¼‰
â”‚   â”‚       â””â”€â”€ UI/           # UIå…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ Tests/                # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ï¼ˆTDDï¼‰
â”‚   â”œâ”€â”€ Editor/               # é–‹ç™ºãƒ„ãƒ¼ãƒ«ï¼ˆTodoUIBuilderï¼‰
â”‚   â”œâ”€â”€ Prefabs/              # UIãƒ—ãƒ¬ãƒ•ã‚¡ãƒ–
â”‚   â””â”€â”€ Scenes/               # ã‚·ãƒ¼ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ Spec.md                   # è©³ç´°ä»•æ§˜æ›¸
â””â”€â”€ Task.md                   # å®Ÿè£…ã‚¿ã‚¹ã‚¯ç®¡ç†
```

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦ç’°å¢ƒ
- Unity 2022.3 LTSä»¥ä¸Š
- .NET Standard 2.1å¯¾å¿œ

### ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
```json
{
  "dependencies": {
    "com.cysharp.unitask": "2.5.10",
    "jp.cysharp.vcontainer": "1.16.9", 
    "com.cysharp.r3": "1.3.0"
  }
}
```

### å®Ÿè¡Œæ–¹æ³•
1. Unityãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã
2. `Assets/Scenes/Main.unity`ã‚’é–‹ã
3. Playãƒœã‚¿ãƒ³ã§ã‚¢ãƒ—ãƒªå®Ÿè¡Œ

### UIå†æ§‹ç¯‰ï¼ˆé–‹ç™ºè€…å‘ã‘ï¼‰
- Unityä¸Šéƒ¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼: `Todo App > Build UI > Build All UI (Complete Setup)`
- è‡ªå‹•ã§Canvasã€SafeAreaã€å…¨UIè¦ç´ ãŒæ§‹ç¯‰ã•ã‚Œã¾ã™

## ğŸ“ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ

### Clean Architectureå®Ÿè£…
- **ä¾å­˜é–¢ä¿‚ã®æµã‚Œ**: Presentation â†’ Application â†’ Domain â† Infrastructure
- **ä¾å­˜é–¢ä¿‚é€†è»¢ã®åŸå‰‡**: InfrastructureãŒDomainã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜
- **ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®ç–çµåˆ**: Assembly Definition Filesã«ã‚ˆã‚‹å¼·åˆ¶åˆ†é›¢

### MVVM + ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
- **View**: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
- **ViewModel**: R3ã«ã‚ˆã‚‹çŠ¶æ…‹ç®¡ç†ã¨ã‚³ãƒãƒ³ãƒ‰å®šç¾©
- **Presenter**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨UseCaseé€£æº
- **åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ UIæ›´æ–°

### TDDå®Ÿè·µ
- **Red Phase**: å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’å…ˆã«æ›¸ã
- **Green Phase**: ãƒ†ã‚¹ãƒˆãŒé€šã‚‹æœ€å°å®Ÿè£…
- **Refactor Phase**: ã‚³ãƒ¼ãƒ‰ã®æ”¹å–„ãƒ»æœ€é©åŒ–

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

---

**ğŸ† Unityã§Clean Architecture + MVVMã‚’å­¦ã¶ãŸã‚ã®å®Œå…¨ãªã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**